server {
    listen 9017;
    server_name localhost;
    root /path/to/out;  # 替换为你的 out 目录的绝对路径
    index index.html;

    # 通用规则：先尝试文件，再尝试 .html，最后回退到 index.html
    location / {
        try_files $uri $uri.html $uri/ /index.html;
    }

    # 处理首页
    location = / {
        try_files /index.html /index.html;
    }

    # 处理书籍详情页（带查询参数）
    location ~ ^/book(\?.*)?$ {
        try_files /book.html /book.html;
    }

    # 处理章节页（带查询参数）
    location ~ ^/book/read(\?.*)?$ {
        try_files /book/read.html /book/read.html;
    }

    # 处理目录页（带查询参数）
    location ~ ^/book/catalog(\?.*)?$ {
        try_files /book/catalog.html /book/catalog.html;
    }

    # 处理分类页（可能带查询参数）
    location ~ ^/category(\?.*)?$ {
        try_files /category.html /category.html;
    }

    # 处理分类列表页（带查询参数）
    location ~ ^/category-list(\?.*)?$ {
        try_files /category-list.html /category-list.html;
    }

    # 静态资源缓存
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # 禁止访问隐藏文件
    location ~ /\. {
        deny all;
    }
}

