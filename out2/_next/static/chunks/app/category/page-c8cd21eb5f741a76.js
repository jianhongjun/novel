(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[572],{1054:function(){},7746:function(e,t,a){Promise.resolve().then(a.bind(a,9805))},9805:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var r=a(9533),o=a(1229),n=a(1250),s=a(8197),c=a(5481),i=a(6289),l=a.n(i),u=a(145),m=a.n(u);function g(){let e=(0,n.useRouter)(),[t,a]=(0,o.useState)("male"),[i,u]=(0,o.useState)([]),[g,p]=(0,o.useState)(!0),d=(0,o.useRef)(null),h=(0,o.useRef)(null),y=(0,o.useRef)(null),f=(0,o.useRef)(null);return(0,o.useEffect)(()=>{(async()=>{try{p(!0);let e=await (0,c.AT)();u(e)}catch(e){console.error("获取分类数据失败:",e)}finally{p(!1)}})()},[]),(0,o.useEffect)(()=>{(()=>{let e=f.current;if(!e)return;if("male"===t){setTimeout(()=>{e.scrollTo({top:0,behavior:"smooth"})},100);return}let a=null;switch(t){case"female":a=h;break;case"publish":a=y}(null==a?void 0:a.current)&&setTimeout(()=>{var e;null==a||null===(e=a.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},100)})()},[t]),(0,r.jsxs)("main",{className:l().pageBase,children:[(0,r.jsx)("div",{className:l().bannerBgBase}),(0,r.jsx)("div",{className:l().bannerBlurBase}),(0,r.jsx)("div",{className:l().bannerBlur2Base}),(0,r.jsxs)("div",{className:m().container,children:[(0,r.jsxs)("header",{className:"".concat(l().headerWithBackBase," ").concat(m().stickyHeader),children:[(0,r.jsx)("button",{className:l().backButtonBase,onClick:()=>e.back(),children:(0,r.jsx)(s.default,{src:"/fh@2x.png",alt:"返回",width:32,height:32,className:l().backIconBase,priority:!0,unoptimized:!0})}),(0,r.jsx)("h1",{className:m().title,children:"分类"})]}),(0,r.jsxs)("section",{className:"".concat(m().tabs," ").concat(m().stickyTabs),children:[(0,r.jsx)("div",{className:m().tabsContainer,children:[{key:"male",label:"男频"},{key:"female",label:"女频"}].map(e=>(0,r.jsx)("button",{onClick:()=>a(e.key),className:"".concat(m().tabItem," ").concat(t===e.key?m().tabActive:""),children:e.label},e.key))}),(0,r.jsx)("div",{className:m().tabsLine})]}),(0,r.jsx)("section",{className:m().content,ref:f,children:g?(0,r.jsx)("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"加载中..."}):0===i.length?(0,r.jsx)("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"暂无分类数据"}):i.map((t,a)=>{let o="男频"===t.type?"male":"女频"===t.type?"female":"publish";return(0,r.jsxs)("div",{ref:"male"===o?d:"female"===o?h:y,className:m().categoryGroup,children:[(0,r.jsx)("h2",{className:m().sectionTitle,children:t.type}),(0,r.jsx)("div",{className:m().categoryList,children:t.list.map(t=>{let a="male"===o?1:"female"===o?2:3;return(0,r.jsxs)("div",{className:m().categoryItem,onClick:()=>{let r="/category-list?category=".concat(encodeURIComponent(t.name),"&freeType=").concat(a);e.push(r)},style:{cursor:"pointer"},children:[(0,r.jsx)("span",{className:m().categoryName,children:t.name}),(0,r.jsx)("img",{src:t.image,alt:t.name,width:93,height:50,className:m().categoryImage,onError:e=>{e.target.src="/fl_1.png"}})]},"".concat(o,"-").concat(t.id))})})]},t.type)})})]})]})}},5481:function(e,t,a){"use strict";a.d(t,{AT:function(){return l},Kr:function(){return p},V4:function(){return u},Z:function(){return g},mG:function(){return m},n5:function(){return c},sk:function(){return i}});var r=a(6161),o=a.n(r);let n="https://config.umeweb.cn";function s(e){let t=Object.keys(e).filter(e=>"sign"!==e).sort((e,t)=>e.localeCompare(t)).map(t=>"".concat(t).concat(e[t])).join(""),a="".concat("weimi_novel_key_20251223").concat(t).toLowerCase();return o().MD5(a).toString()}function c(){try{let e="novel_user_id",t=localStorage.getItem(e);if(!t){t=Date.now().toString(36)+Math.random().toString(36).substr(2,5);try{localStorage.setItem(e,t)}catch(e){console.warn("localStorage 不可用，使用临时用户 ID:",e)}}return t}catch(e){return console.warn("获取用户 ID 失败，使用临时 ID:",e),Date.now().toString(36)+Math.random().toString(36).substr(2,5)}}async function i(){try{var e;let t=c(),a=Date.now().toString(),r={uid:t,timestamp:a},o=s(r);r.sign=o,console.log("请求推荐小说，参数:",{uid:t,timestamp:a,sign:o.substring(0,8)+"..."});let i=await fetch("".concat(n,"/browser_business/novel/recommend"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(console.log("API 响应状态:",i.status,i.statusText),!i.ok){let e=await i.text();throw console.error("HTTP 错误响应:",e),Error("HTTP error! status: ".concat(i.status,", message: ").concat(e.substring(0,100)))}let l=await i.json();if(console.log("API 返回数据:",{code:l.code,hasResult:!!l.result,resultLength:null===(e=l.result)||void 0===e?void 0:e.length}),200!==l.code){let e=l.message||"获取推荐小说失败";throw console.error("API 返回错误:",e,l),Error(e)}let u=(l.result||[]).map((e,t)=>({id:e.cbid,title:e.title,author:e.author,status:e.status,cover:e.cover,freeType:e.freeType,category:e.category,recommend:e.recommend,bookshelf:e.bookshelf}));return console.log("成功获取小说列表，数量:",u.length),u}catch(e){if(console.error("获取推荐小说失败:",e),e instanceof TypeError&&e.message.includes("fetch"))throw Error("网络请求失败，请检查网络连接");if(e instanceof Error)throw e;throw Error("获取推荐小说失败，请稍后重试")}}async function l(){try{let e=Date.now().toString(),t=s({timestamp:e}),a=await fetch("".concat(n,"/browser_business/novel/category"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sign:t,timestamp:parseInt(e)})});if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));let r=await a.json();if(200!==r.code)throw Error(r.message||"获取分类列表失败");let o=r.result||{},c=[];return o["1"]&&o["1"].length>0&&c.push({type:"男频",list:o["1"].map((e,t)=>({id:t+1,name:e.category,image:e.cover}))}),o["2"]&&o["2"].length>0&&c.push({type:"女频",list:o["2"].map((e,t)=>({id:t+1,name:e.category,image:e.cover}))}),o["3"]&&o["3"].length>0&&c.push({type:"出版物",list:o["3"].map((e,t)=>({id:t+1,name:e.category,image:e.cover}))}),c}catch(e){throw console.error("获取分类列表失败:",e),e}}async function u(e){try{let t=Date.now().toString(),a=e.pageNum||1,r=e.pageSize||20,o={timestamp:t,pageNum:a.toString(),pageSize:r.toString(),category:e.category,freeType:e.freeType.toString()},c=s(o),i=await fetch("".concat(n,"/browser_business/novel/category_list"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sign:c,timestamp:parseInt(t),pageNum:a,pageSize:r,category:e.category,freeType:e.freeType})});if(!i.ok)throw Error("HTTP error! status: ".concat(i.status));let l=await i.json();if(200!==l.code)throw Error(l.message||"获取分类列表失败");let u=l.result||{total:0,pages:0,data:[]};return{books:u.data.map(e=>({id:e.cbid,cbid:e.cbid,title:e.title,intro:e.intro||"",freeTypeName:e.freeTypeName||"",categoryName:e.categoryName||"",subCategoryName:e.subCategoryName||"",allWords:e.allWords||0,allChapter:e.allChapter||0,freeChapters:e.freeChapters||0,authorName:e.authorName||"",coverUrl:e.coverUrl||"",status:e.status||"连载",tags:e.tags||[],updateTime:e.updateTime||"",site:e.site||""})),total:u.total,pages:u.pages}}catch(e){throw console.error("获取分类列表失败:",e),e}}async function m(e){try{let t=Date.now().toString(),a=s({timestamp:t,cbid:e}),r=await fetch("".concat(n,"/browser_business/novel/info"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cbid:e,sign:a,timestamp:parseInt(t)})});if(!r.ok)throw Error("HTTP error! status: ".concat(r.status));let o=await r.json();if(200!==o.code)throw Error(o.message||"获取书籍详情失败");let c=o.result||{};return{id:c.cbid,cbid:c.cbid,title:c.title||"",authorName:c.authorName||"",site:c.site?"来源".concat(c.site):"",coverUrl:c.coverUrl||"",intro:c.intro||"",status:c.status||"连载",freeTypeName:c.freeTypeName||"",categoryName:c.categoryName||"",subCategoryName:c.subCategoryName||"",allWords:c.allWords||0,allChapter:c.allChapter||0,freeChapters:c.freeChapters||0,tags:c.tags||[],updateTime:c.updateTime||""}}catch(e){throw console.error("获取书籍详情失败:",e),e}}async function g(e){try{let t=Date.now().toString(),a=e.pageNum||1,r=e.pageSize||20,o={timestamp:t,cbid:e.cbid,pageNum:a.toString(),pageSize:r.toString()},c=s(o),i=await fetch("".concat(n,"/browser_business/novel/chapter_list"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cbid:e.cbid,pageNum:a,pageSize:r,sign:c,timestamp:parseInt(t)})});if(!i.ok)throw Error("HTTP error! status: ".concat(i.status));let l=await i.json();if(200!==l.code)throw Error(l.message||"获取章节列表失败");return l.result||{totalCount:0,resultData:[],pages:0}}catch(e){throw console.error("获取章节列表失败:",e),e}}async function p(e){try{let t=Date.now().toString(),a=e.uid||c(),r={timestamp:t,cbid:e.cbid,uid:a,ccid:e.ccid},o=s(r),i=await fetch("".concat(n,"/browser_business/novel/chapter_content"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cbid:e.cbid,uid:a,ccid:e.ccid,sign:o,timestamp:parseInt(t)})});if(!i.ok)throw Error("HTTP error! status: ".concat(i.status));let l=await i.json();if(200!==l.code)throw Error(l.message||"获取章节内容失败");return l.result||{}}catch(e){throw console.error("获取章节内容失败:",e),e}}},145:function(e){e.exports={container:"page_container__9aUEM",stickyHeader:"page_stickyHeader__kogx9",title:"page_title__3Wd2V",tabs:"page_tabs__TUKYK",tabsContainer:"page_tabsContainer__BQGSf",tabItem:"page_tabItem__tYsGM",tabActive:"page_tabActive__5yx6r",tabsLine:"page_tabsLine___i86i",content:"page_content__gTLBN",sectionTitle:"page_sectionTitle__jmczM",categoryList:"page_categoryList__B_4Qk",categoryGroup:"page_categoryGroup__X7VMO",categoryItem:"page_categoryItem__k0Ykb",categoryName:"page_categoryName__nAEnE",categoryImage:"page_categoryImage__ZNa7F"}},6289:function(e){e.exports={pageBase:"common_pageBase__qitDy",pageBase2:"common_pageBase2__OVo5w",bannerBgBase:"common_bannerBgBase__X4J1N",bannerBlurBase:"common_bannerBlurBase__03GAE",bannerBlur2Base:"common_bannerBlur2Base__yimuN",headerBase:"common_headerBase__zHnZO",backButtonBase:"common_backButtonBase__pJynL",backIconBase:"common_backIconBase__LIW2m",headerWithBackBase:"common_headerWithBackBase__ZrM5F"}}},function(e){e.O(0,[541,264,197,170,842,744],function(){return e(e.s=7746)}),_N_E=e.O()}]);