(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[785],{1054:function(){},5398:function(e,t,o){Promise.resolve().then(o.bind(o,9337))},9337:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return d}});var a=o(9533),r=o(1229),s=o(1250),n=o(8197),c=o(5481),i=o(6289),l=o.n(i),g=o(1519),u=o.n(g);function p(){let e=(0,s.useRouter)(),t=(0,s.useSearchParams)(),o=t.get("category")||"玄幻",i=t.get("freeType"),g=i?parseInt(i):1;(0,r.useEffect)(()=>{},[o,g,i]);let[p,d]=(0,r.useState)([]),[h,m]=(0,r.useState)(!0),[_,b]=(0,r.useState)(null),[f,y]=(0,r.useState)("全部"),[k,N]=(0,r.useState)("全部");return(0,r.useEffect)(()=>{(async()=>{try{m(!0),b(null);let e=await (0,c.V4)({category:o,freeType:g,pageNum:1,pageSize:20});d(e.books)}catch(e){console.error("获取分类列表数据失败:",e),b(e instanceof Error?e.message:"获取分类列表失败")}finally{m(!1)}})()},[o,g]),(0,a.jsxs)("main",{className:l().pageBase,children:[(0,a.jsx)("div",{className:l().bannerBgBase}),(0,a.jsx)("div",{className:l().bannerBlurBase}),(0,a.jsx)("div",{className:l().bannerBlur2Base}),(0,a.jsxs)("div",{className:u().container,children:[(0,a.jsx)("header",{className:"".concat(l().headerWithBackBase," ").concat(u().stickyHeader),children:(0,a.jsx)("button",{className:l().backButtonBase,onClick:()=>e.back(),children:(0,a.jsx)(n.default,{src:"/fh@2x.png",alt:"返回",width:32,height:32,className:l().backIconBase,priority:!0,unoptimized:!0})})}),(0,a.jsxs)("div",{className:u().scrollArea,children:[(0,a.jsx)("div",{className:u().titleSection,children:(0,a.jsx)("h1",{className:u().title,children:o})}),(0,a.jsx)("section",{className:u().bookList,children:h?(0,a.jsx)("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"加载中..."}):_?(0,a.jsx)("div",{style:{padding:"20px",textAlign:"center",color:"#f06e2b"},children:_}):0===p.length?(0,a.jsx)("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"暂无数据"}):p.map(t=>(0,a.jsxs)("div",{className:u().bookItem,onClick:()=>e.push("/book?id=".concat(t.id)),style:{cursor:"pointer"},children:[(0,a.jsxs)("div",{className:u().bookCoverWrapper,children:[(0,a.jsx)("img",{src:t.coverUrl,alt:t.title,width:80,height:110,className:u().bookCover,onError:e=>{e.target.src="/1.png"}}),(0,a.jsx)("span",{className:u().bookBadge,children:t.status})]}),(0,a.jsxs)("div",{className:u().bookInfo,children:[(0,a.jsx)("div",{className:u().bookTitle,children:t.title}),(0,a.jsxs)("div",{className:u().bookMeta,children:[(0,a.jsx)(n.default,{src:"/author@2x.png",alt:t.authorName||"",width:13,height:13,className:u().authorIcon,unoptimized:!0}),(0,a.jsx)("span",{className:u().bookAuthor,children:t.authorName}),(0,a.jsx)("span",{className:u().dot}),(0,a.jsx)("div",{className:u().bookTagsContainer,children:t.tags&&t.tags.length>0?t.tags.map((e,o)=>(0,a.jsxs)("span",{className:u().bookTag,children:[o>0&&(0,a.jsx)("span",{className:u().tagDot,children:"\xb7"}),e]},"".concat(t.id,"-").concat(e,"-").concat(o))):(0,a.jsx)("span",{className:u().bookTag,children:o})})]}),(0,a.jsx)("p",{className:u().bookDesc,children:t.intro})]})]},t.id))})]})]})]})}function d(){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)("div",{children:"Loading..."}),children:(0,a.jsx)(p,{})})}},5481:function(e,t,o){"use strict";o.d(t,{AT:function(){return l},Kr:function(){return d},V4:function(){return g},Z:function(){return p},mG:function(){return u},n5:function(){return c},sk:function(){return i}});var a=o(6161),r=o.n(a);let s="https://config.umeweb.cn";function n(e){let t=Object.keys(e).filter(e=>"sign"!==e).sort((e,t)=>e.localeCompare(t)).map(t=>"".concat(t).concat(e[t])).join(""),o="".concat("weimi_novel_key_20251223").concat(t).toLowerCase();return r().MD5(o).toString()}function c(){try{let e="novel_user_id",t=localStorage.getItem(e);if(!t){t=Date.now().toString(36)+Math.random().toString(36).substr(2,5);try{localStorage.setItem(e,t)}catch(e){console.warn("localStorage 不可用，使用临时用户 ID:",e)}}return t}catch(e){return console.warn("获取用户 ID 失败，使用临时 ID:",e),Date.now().toString(36)+Math.random().toString(36).substr(2,5)}}async function i(){try{var e;let t=c(),o=Date.now().toString(),a={uid:t,timestamp:o},r=n(a);a.sign=r,console.log("请求推荐小说，参数:",{uid:t,timestamp:o,sign:r.substring(0,8)+"..."});let i=await fetch("".concat(s,"/browser_business/novel/recommend"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(console.log("API 响应状态:",i.status,i.statusText),!i.ok){let e=await i.text();throw console.error("HTTP 错误响应:",e),Error("HTTP error! status: ".concat(i.status,", message: ").concat(e.substring(0,100)))}let l=await i.json();if(console.log("API 返回数据:",{code:l.code,hasResult:!!l.result,resultLength:null===(e=l.result)||void 0===e?void 0:e.length}),200!==l.code){let e=l.message||"获取推荐小说失败";throw console.error("API 返回错误:",e,l),Error(e)}let g=(l.result||[]).map((e,t)=>({id:e.cbid,title:e.title,author:e.author,status:e.status,cover:e.cover,freeType:e.freeType,category:e.category,recommend:e.recommend,bookshelf:e.bookshelf}));return console.log("成功获取小说列表，数量:",g.length),g}catch(e){if(console.error("获取推荐小说失败:",e),e instanceof TypeError&&e.message.includes("fetch"))throw Error("网络请求失败，请检查网络连接");if(e instanceof Error)throw e;throw Error("获取推荐小说失败，请稍后重试")}}async function l(){try{let e=Date.now().toString(),t=n({timestamp:e}),o=await fetch("".concat(s,"/browser_business/novel/category"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sign:t,timestamp:parseInt(e)})});if(!o.ok)throw Error("HTTP error! status: ".concat(o.status));let a=await o.json();if(200!==a.code)throw Error(a.message||"获取分类列表失败");let r=a.result||{},c=[];return r["1"]&&r["1"].length>0&&c.push({type:"男频",list:r["1"].map((e,t)=>({id:t+1,name:e.category,image:e.cover}))}),r["2"]&&r["2"].length>0&&c.push({type:"女频",list:r["2"].map((e,t)=>({id:t+1,name:e.category,image:e.cover}))}),r["3"]&&r["3"].length>0&&c.push({type:"出版物",list:r["3"].map((e,t)=>({id:t+1,name:e.category,image:e.cover}))}),c}catch(e){throw console.error("获取分类列表失败:",e),e}}async function g(e){try{let t=Date.now().toString(),o=e.pageNum||1,a=e.pageSize||20,r={timestamp:t,pageNum:o.toString(),pageSize:a.toString(),category:e.category,freeType:e.freeType.toString()},c=n(r),i=await fetch("".concat(s,"/browser_business/novel/category_list"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sign:c,timestamp:parseInt(t),pageNum:o,pageSize:a,category:e.category,freeType:e.freeType})});if(!i.ok)throw Error("HTTP error! status: ".concat(i.status));let l=await i.json();if(200!==l.code)throw Error(l.message||"获取分类列表失败");let g=l.result||{total:0,pages:0,data:[]};return{books:g.data.map(e=>({id:e.cbid,cbid:e.cbid,title:e.title,intro:e.intro||"",freeTypeName:e.freeTypeName||"",categoryName:e.categoryName||"",subCategoryName:e.subCategoryName||"",allWords:e.allWords||0,allChapter:e.allChapter||0,freeChapters:e.freeChapters||0,authorName:e.authorName||"",coverUrl:e.coverUrl||"",status:e.status||"连载",tags:e.tags||[],updateTime:e.updateTime||"",site:e.site||""})),total:g.total,pages:g.pages}}catch(e){throw console.error("获取分类列表失败:",e),e}}async function u(e){try{let t=Date.now().toString(),o=n({timestamp:t,cbid:e}),a=await fetch("".concat(s,"/browser_business/novel/info"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cbid:e,sign:o,timestamp:parseInt(t)})});if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));let r=await a.json();if(200!==r.code)throw Error(r.message||"获取书籍详情失败");let c=r.result||{};return{id:c.cbid,cbid:c.cbid,title:c.title||"",authorName:c.authorName||"",site:c.site?"来源".concat(c.site):"",coverUrl:c.coverUrl||"",intro:c.intro||"",status:c.status||"连载",freeTypeName:c.freeTypeName||"",categoryName:c.categoryName||"",subCategoryName:c.subCategoryName||"",allWords:c.allWords||0,allChapter:c.allChapter||0,freeChapters:c.freeChapters||0,tags:c.tags||[],updateTime:c.updateTime||""}}catch(e){throw console.error("获取书籍详情失败:",e),e}}async function p(e){try{let t=Date.now().toString(),o=e.pageNum||1,a=e.pageSize||20,r={timestamp:t,cbid:e.cbid,pageNum:o.toString(),pageSize:a.toString()},c=n(r),i=await fetch("".concat(s,"/browser_business/novel/chapter_list"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cbid:e.cbid,pageNum:o,pageSize:a,sign:c,timestamp:parseInt(t)})});if(!i.ok)throw Error("HTTP error! status: ".concat(i.status));let l=await i.json();if(200!==l.code)throw Error(l.message||"获取章节列表失败");return l.result||{totalCount:0,resultData:[],pages:0}}catch(e){throw console.error("获取章节列表失败:",e),e}}async function d(e){try{let t=Date.now().toString(),o=e.uid||c(),a={timestamp:t,cbid:e.cbid,uid:o,ccid:e.ccid},r=n(a),i=await fetch("".concat(s,"/browser_business/novel/chapter_content"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cbid:e.cbid,uid:o,ccid:e.ccid,sign:r,timestamp:parseInt(t)})});if(!i.ok)throw Error("HTTP error! status: ".concat(i.status));let l=await i.json();if(200!==l.code)throw Error(l.message||"获取章节内容失败");return l.result||{}}catch(e){throw console.error("获取章节内容失败:",e),e}}},1519:function(e){e.exports={container:"page_container___U_CM",stickyHeader:"page_stickyHeader__d6dNl",titleSection:"page_titleSection__VkfgJ",title:"page_title__ncQqp",filters:"page_filters__URsqv",filterRow:"page_filterRow__nPJyW",filterButton:"page_filterButton__4w2p9",filterActive:"page_filterActive__xfuij",placeholder:"page_placeholder__htEcm",scrollArea:"page_scrollArea__JWcYn",bookList:"page_bookList__qqSJ3",bookItem:"page_bookItem__Al2Q_",bookCoverWrapper:"page_bookCoverWrapper__1IMvw",bookCover:"page_bookCover__G1llu",bookBadge:"page_bookBadge__7YFOy",bookInfo:"page_bookInfo__7pBDX",bookTitle:"page_bookTitle___sN7Q",bookMeta:"page_bookMeta__xtnrp",authorIcon:"page_authorIcon__Pezgo",bookAuthor:"page_bookAuthor__0_Apg",dot:"page_dot__S1UJO",bookTagsContainer:"page_bookTagsContainer__x4I_q",bookTag:"page_bookTag__IPksk",tagDot:"page_tagDot__eEpvo",bookDesc:"page_bookDesc__cjR8d"}},6289:function(e){e.exports={pageBase:"common_pageBase__qitDy",pageBase2:"common_pageBase2__OVo5w",bannerBgBase:"common_bannerBgBase__X4J1N",bannerBlurBase:"common_bannerBlurBase__03GAE",bannerBlur2Base:"common_bannerBlur2Base__yimuN",headerBase:"common_headerBase__zHnZO",backButtonBase:"common_backButtonBase__pJynL",backIconBase:"common_backIconBase__LIW2m",headerWithBackBase:"common_headerWithBackBase__ZrM5F"}}},function(e){e.O(0,[541,264,197,170,842,744],function(){return e(e.s=5398)}),_N_E=e.O()}]);